<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Internationalization — Backend Development</title>
  <link rel="stylesheet" type="text/css" href="stylesheets/style.css">
  <link rel="stylesheet" type="text/css" href="stylesheets/dark.css">
  <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">

  <link rel="stylesheet" type="text/css" href="stylesheets/code.css">

  <link rel="stylesheet" type="text/css" href="stylesheets/fixes.css">

  <link href="images/favicon.ico" rel="shortcut icon" type="image/x-icon">
  <style>

    .slide img[src$=svg] {
      width: 100%;
    }
  </style>
</head>
<body class="guide">
  <div>
    <a href="https://github.com/backend-development/backend-development-textbook/"><img style="position: fixed; top: 0; right: 0; border: 0; z-index: 10;" src="images/forkme.png" alt="Fork me on GitHub"></a>
  </div>
  <div id="topNav">
    <div class="wrapper">
      <strong class="more-info-label">More Rails: </strong>
      <ul class="more-info-links s-hidden">
        <li class="more-info"><a href="https://guides.rubyonrails.org/">Rails Guides</a></li>
        <li class="more-info"><a href="https://railsbridge.projects.multimediatechnology.at/docs/">Railsbridge</a></li>
        <li class="more-info"><a href="https://archive.org/details/podcast_railscasts_218282043">Railscasts</a></li>
      </ul>
      <strong class="more-info-label">Beyond Backend: </strong>
      <ul class="more-info-links s-hidden">
        <li class="more-info"><a href="https://web-engineering.github.io/">Web Engineering</a></li>
      </ul>
    </div>
  </div>
  <div id="header">
    <div class="wrapper clearfix">
      <h1><a href="index.html" title="Return to home page">Backend<span> Development</span></a></h1>
      <ul class="nav">
        <li><a class="nav-item" href="index.html">Home</a></li>
        <li class="guides-index guides-index-large">
          <a href="index.html" onclick="guideMenu(); return false;" id="guidesMenu" class="guides-index-item nav-item">Index  &#x25BC;</a>
          <div id="guides" class="clearfix" style="display: none;">
            <hr>
              <dl class="L">
                <dt>Ruby on Rails</dt>
                <dd><a href="ruby_commandline.html">Ruby Commandline</a></dd>
                <dd><a href="rails_database_and_model.html">Models and ActiveRecord</a></dd>
                <dd><a href="rails_db.html">Database and Migrations</a></dd>
                <dd><a href="rails_associations_and_validations.html">Associations and Validations</a></dd>
                <dd><a href="rails_view_and_controller.html">Routing, View and Controller</a></dd>
                <dd><a href="rails_authentication.html">Simple Authentication</a></dd>
                <dd><a href="asset_pipeline.html">The Asset Pipeline</a></dd>
                <dd><a href="javascript_and_ajax.html">Rails and old Javascript</a></dd>
                <dd><a href="javascript_webpack_frontend.html">Rails and Webpack</a></dd>
                <dd><a href="testing.html">Getting started with Testing</a></dd>
                <dd><a href="rails_gems.html">Ruby Gems for your Rails Project</a></dd>
                <dd><a href="rest-api.html">REST API</a></dd>
                <dd><a href="graphql-api.html">GraphQL API</a></dd>
                <dd><a href="rails_websockets.html">Websocket in Rails</a></dd>
                <dd><a href="jobs_and_tasks.html">Jobs and Tasks in Rails</a></dd>
                <dd><a href="refactoring_rails.html">Refactoring Rails</a></dd>
                <dd><a href="rails_security.html">Rails Security</a></dd>
                <dt>Overarching Concerns</dt>
                <dd><a href="security.html">Security</a></dd>
                <dd><a href="adv_authentication.html">Advanced Authentication</a></dd>
                <dd><a href="caching.html">Caching</a></dd>
                <dd><a href="advanced_testing.html">Advanced Testing</a></dd>
                <dd><a href="internationalization.html">Internationalization (I18n)</a></dd>
                <dd><a href="git_rebasing.html">Git Rebasing</a></dd>
                <dt>Nodes.js</dt>
                <dd><a href="node_vs_rails.html">Node vs. Rails</a></dd>
                <dd><a href="node_basics.html">Node Basics</a></dd>
                <dd><a href="node_websockets.html">Node Websockets</a></dd>
                <dd><a href="node_express.html">Node Web App</a></dd>
                <dd><a href="node_cluster.html">Scaling Node</a></dd>
                <dt>Next.js</dt>
                <dd><a href="nextjs.html">Next.js</a></dd>
              </dl>
              <dl class="R">
              </dl>
          </div>
        </li>
      </ul>
    </div>
  </div>

  <hr class="hide">

  <div id="feature">
    <div class="wrapper">
      <h2 id="preheader">Internationalization</h2>
                <div id="subCol">
            <h3 class="chapter"><img src="images/chapters_icon.gif" alt="" />Chapters</h3>
            <ol class="chapters">
<li><a href="#internationalization-and-localization">Internationalization and Localization</a></li>
<li><a href="#the-big-picture">The big picture</a></li>
<li><a href="#focus-on-language">Focus on Language</a></li>
<li><a href="#i18n-in-rails">I18n in Rails</a></li>
<li><a href="#keys-and-translations">keys and translations</a></li>
<li><a href="#locale-files-included-with-the-i18n-gem">locale files included with the I18n gem</a></li>
<li><a href="#dates">Dates</a></li>
<li><a href="#relative-dates">Relative Dates</a></li>
<li><a href="#pluralization">Pluralization</a></li>
<li><a href="#translating-model-names-and-attributes">Translating Model Names and Attributes</a></li>
<li><a href="#see-also">See Also</a></li>
</ol>

          </div>

      <div class="rest_header">
        <h2>Internationalization</h2><p>This guide will give you an overview
of the problems you face when writing an app
that&#39;s used in many countries, in many languages.
After reading it you should be familiar with:</p>
<ul class="checkmark">
<li>the concepts of Internationalization and Localisation</li>
<li>the Rails I18n gem</li>
<li>how Rails handles some of the most important topics

<ul class="checkmark">
<li>handling dates</li>
<li>handling numbers and plurals</li>
</ul></li>
</ul>
<p>You can use the <a href="https://gitlab.mediacube.at/bjelline/statement_shirts">Demo App</a> to try out the concepts step by step.</p>
      </div>
    </div>
  </div>


  <div id="container">
    <div class="wrapper">
      <div id="mainCol">
        <div class='slide'>
</div>
<div class='slide'>
<a class='slide_break' id='slide-0' href='slides_internationalization.html#/0'>▻</a>
<h3 id="internationalization-and-localization">
<a class="anchorlink" href="#internationalization-and-localization"></a>1 Internationalization and Localization</h3><p>Internationalization is the process of designing a software application so that it can be adapted to various languages and regions. It is often written as I18n (to avoid typing 18 letters).</p><p>Localization is the process of adapting internationalized software for a specific region or language by translating text and adding locale-specific components. It is often written as L10n (to avoid typing 10 letters).</p><p>Localization (which is potentially performed multiple times, for different locales) uses the infrastructure or flexibility provided by internationalization (which is ideally performed only once before localization, or as an integral part of ongoing development).</p></div>
<div class='slide'>
<a class='slide_break' id='slide-1' href='slides_internationalization.html#/1'>▻</a>
<h3 id="the-big-picture">
<a class="anchorlink" href="#the-big-picture"></a>2 The big picture</h3><p>When developing web applications for different countries, cultures, languages
we are faced with many different problems:</p>
<ul>
<li>Different cultures will have very different ideas of what a "good" website looks like. See <a href="https://www.youtube.com/watch?v=ER3534JJucc">Jenny Shen's talk at concat</a>
</li>
<li>Different writing systems will use a diffrent amount of space, leading to diffrent layouts</li>
<li>Writing direction (left-to-right, right-to-left or top-down) will need to be handled by HTML. See <a href="https://www.w3.org/International/questions/qa-html-dir">w3c</a>
</li>
<li>The app might need to handle different currencies and methods of payment</li>
</ul>
</div>
<div class='slide'>
<a class='slide_break' id='slide-2' href='slides_internationalization.html#/2'>▻</a>
<h3 id="focus-on-language">
<a class="anchorlink" href="#focus-on-language"></a>3 Focus on Language</h3><p>Internationalization is mostly concerned with language and translation.
Even if we focus on indo-european languages we will find differences:</p>
<ul>
<li>Example: Plurals  in Polish <a href="https://www.tiktok.com/@stach_mat/video/7325101589084130592">Polnisch für Anfänger by stach_mat, Teil 5</a>
</li>
</ul>
<p>Going from a mono-lingual to a multi-lingual app will
add another layer of abstraction that will make both programming
and testing harder.</p></div>
<div class='slide'>
<a class='slide_break' id='slide-3' href='slides_internationalization.html#/3'>▻</a>
<h3 id="i18n-in-rails">
<a class="anchorlink" href="#i18n-in-rails"></a>4 I18n in Rails</h3><p>Rails Apps are ready for Internationalization. To get started,
find the file <code>config/locale/en.yml</code>.  It only contains one example
of a translation string:</p><div class="code_container">
<pre><code class="highlight yml"><span class="na">en</span><span class="pi">:</span>
  <span class="na">hello</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Hello</span><span class="nv"> </span><span class="s">world"</span>
</code></pre>
</div>
<p>This means, that in the <code>:en</code> locale, the key <code>hello</code> will map to the <code>Hello world</code> string</p><p>The <a href="https://gitlab.mediacube.at/bjelline/statement_shirts">Demo App</a> is already
prepared to switch between locales through folders:</p>
<ul>
<li>
<a href="http://localhost:3000/">http://localhost:3000/</a> - Home page and order page - english</li>
<li>
<a href="http://localhost:3000/de/">http://localhost:3000/de/</a> - Home page and order page - german</li>
<li>
<a href="http://localhost:3000/dk/">http://localhost:3000/dk/</a> - Home page and order page - danish</li>
<li>
<a href="http://localhost:3000/es/">http://localhost:3000/es/</a> - Home page and order page - spanish</li>
<li>
<a href="http://localhost:3000/shirts">http://localhost:3000/shirts</a> - List of all shirts - english</li>
<li>
<a href="http://localhost:3000/de/shirts">http://localhost:3000/de/shirts</a> - List of all shirts - english</li>
<li>
<a href="http://localhost:3000/dk/shirts">http://localhost:3000/dk/shirts</a> - List of all shirts - danish</li>
<li>
<a href="http://localhost:3000/en/shirts">http://localhost:3000/en/shirts</a> - List of all shirts - spanish</li>
</ul>
<p>and so on.</p></div>
<div class='slide'>
<a class='slide_break' id='slide-4' href='slides_internationalization.html#/4'>▻</a>
<h3 id="keys-and-translations">
<a class="anchorlink" href="#keys-and-translations"></a>5 keys and translations</h3><p>The method <code>I18n.translate</code> or <code>I18n.t</code> can be used to look up translation.
In our example before the key was <code>hello</code>. In english <code>t 'hello'</code> will return "Hello World"
and in German it would be "Hallo Welt".</p><p>In the view we can use the even short form:</p><div class="code_container">
<pre><code class="highlight erb"><span class="cp">&lt;%=</span> <span class="n">t</span> <span class="s1">'hello'</span> <span class="cp">%&gt;</span>
</code></pre>
</div>
<p>If no translation can be found - because there is no yaml file or because
the key is missing, then a span with class <code>translation_missing</code> will be wrapped
around the text.  The key itself will be used in place of a translation:</p><div class="code_container">
<pre><code class="highlight html"><span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"translation_missing"</span> <span class="na">title=</span><span class="s">"translation missing: dk.hello"</span><span class="nt">&gt;</span>Hello<span class="nt">&lt;/span&gt;</span>
</code></pre>
</div>
<p>Texts in views all need to be replaced by translation keys.</p></div>
<div class='slide'>
<a class='slide_break' id='slide-5' href='slides_internationalization.html#/5'>▻</a>
<h3 id="locale-files-included-with-the-i18n-gem">
<a class="anchorlink" href="#locale-files-included-with-the-i18n-gem"></a>6 locale files included with the I18n gem</h3><p>The I18n gem comes with translations for many languages in the  <a href="https://github.com/svenfuchs/rails-i18n/tree/10141c451f03d7c6b78cfdcce808c389da6b9ddd/rails/locale">locale folder</a>.</p><p>You can copy the ones you need to your own apps <code>config/locale</code> folder
to use them.</p><p>If you are following along with the demo app, do this now for english, german, danish and spanish!</p></div>
<div class='slide'>
<a class='slide_break' id='slide-6' href='slides_internationalization.html#/6'>▻</a>
<h3 id="dates">
<a class="anchorlink" href="#dates"></a>7 Dates</h3><p>Dates are a special case for translation: there are complex and different rules
for displaying dates in different languages.</p><p>The page <code>/order_items</code> gives a list of all orders, with a timestamp when each order was placed:</p><div class="code_container">
<pre><code class="highlight erb">  <span class="nt">&lt;p&gt;</span>
    <span class="nt">&lt;strong&gt;</span>Order Date:<span class="nt">&lt;/strong&gt;</span>
    <span class="cp">&lt;%=</span> <span class="n">order_item</span><span class="p">.</span><span class="nf">created_at</span> <span class="cp">%&gt;</span>
  <span class="nt">&lt;/p&gt;</span>
</code></pre>
</div>
<p>We can use the method <code>I18n.localize</code> or <code>I18n.l</code> in the view to
display this in a language appropriate format:</p><div class="code_container">
<pre><code class="highlight erb">  <span class="nt">&lt;p&gt;</span>
    <span class="nt">&lt;strong&gt;</span>Order Date:<span class="nt">&lt;/strong&gt;</span>
    <span class="cp">&lt;%=</span><span class="n">l</span> <span class="n">order_item</span><span class="p">.</span><span class="nf">created_at</span> <span class="cp">%&gt;</span>
  <span class="nt">&lt;/p&gt;</span>
</code></pre>
</div>
<p>In German this will be displayed as:</p><div class="code_container">
<pre><code class="highlight html">  <span class="nt">&lt;p&gt;</span>
    <span class="nt">&lt;strong&gt;</span>Order Date:<span class="nt">&lt;/strong&gt;</span>
    Montag, 01. April 2024, 21:25 Uhr
  <span class="nt">&lt;/p&gt;</span>
</code></pre>
</div>
<p>You can find the definition for this date in <code>de.yml</code> under <code>de.time.formats.default</code>:</p><div class="code_container">
<pre><code class="highlight yml">  <span class="na">time</span><span class="pi">:</span>
    <span class="na">formats</span><span class="pi">:</span>
      <span class="na">default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">%A,</span><span class="nv"> </span><span class="s">%d.</span><span class="nv"> </span><span class="s">%B</span><span class="nv"> </span><span class="s">%Y,</span><span class="nv"> </span><span class="s">%H:%M</span><span class="nv"> </span><span class="s">Uhr"</span>
      <span class="na">long</span><span class="pi">:</span> <span class="s2">"</span><span class="s">%A,</span><span class="nv"> </span><span class="s">%d.</span><span class="nv"> </span><span class="s">%B</span><span class="nv"> </span><span class="s">%Y,</span><span class="nv"> </span><span class="s">%H:%M</span><span class="nv"> </span><span class="s">Uhr"</span>
      <span class="na">short</span><span class="pi">:</span> <span class="s2">"</span><span class="s">%d.</span><span class="nv"> </span><span class="s">%b,</span><span class="nv"> </span><span class="s">%H:%M</span><span class="nv"> </span><span class="s">Uhr"</span>
</code></pre>
</div>
<p>To choose another format, you can add call <code>l</code> with the format option:</p><div class="code_container">
<pre><code class="highlight erb">  <span class="nt">&lt;p&gt;</span>
    <span class="nt">&lt;strong&gt;</span>Order Date:<span class="nt">&lt;/strong&gt;</span>
    <span class="cp">&lt;%=</span><span class="n">l</span> <span class="n">order_item</span><span class="p">.</span><span class="nf">created_at</span><span class="p">,</span> <span class="ss">format: :short</span> <span class="cp">%&gt;</span>
  <span class="nt">&lt;/p&gt;</span>
</code></pre>
</div>
<p>Different languages will have different format, here a comparison of <code>:short</code>:</p><div class="code_container">
<pre><code class="highlight yml"><span class="na">en</span><span class="pi">:</span>
  <span class="na">short</span><span class="pi">:</span> <span class="s2">"</span><span class="s">%d</span><span class="nv"> </span><span class="s">%b</span><span class="nv"> </span><span class="s">%H:%M"</span>
<span class="na">es</span><span class="pi">:</span>
  <span class="na">short</span><span class="pi">:</span> <span class="s2">"</span><span class="s">%-d</span><span class="nv"> </span><span class="s">de</span><span class="nv"> </span><span class="s">%b</span><span class="nv"> </span><span class="s">%H:%M"</span>
<span class="na">da</span><span class="pi">:</span>
  <span class="na">short</span><span class="pi">:</span> <span class="s2">"</span><span class="s">%e.</span><span class="nv"> </span><span class="s">%b</span><span class="nv"> </span><span class="s">%Y,</span><span class="nv"> </span><span class="s">%H.%M"</span>
<span class="na">de</span><span class="pi">:</span>
  <span class="na">short</span><span class="pi">:</span> <span class="s2">"</span><span class="s">%d.</span><span class="nv"> </span><span class="s">%b,</span><span class="nv"> </span><span class="s">%H:%M</span><span class="nv"> </span><span class="s">Uhr"</span>
</code></pre>
</div>
<p>As you can see, it is not only the names of weekdays and months that are
translated, but also the whole format changes from language to language.</p><p>You could add other formats than ':long' and ':short'  to your translations
by adding to the <code>.yml</code> files.  Just make sure to keep the keys consistent through all languages!</p></div>
<div class='slide'>
<a class='slide_break' id='slide-7' href='slides_internationalization.html#/7'>▻</a>
<h3 id="relative-dates">
<a class="anchorlink" href="#relative-dates"></a>8 Relative Dates</h3><p>The helper <code>time_ago_in_words</code> is already localized, you
can use it directly:</p><div class="code_container">
<pre><code class="highlight erb">  <span class="nt">&lt;p&gt;</span>
    <span class="nt">&lt;strong&gt;</span>Order Date:<span class="nt">&lt;/strong&gt;</span>
    <span class="cp">&lt;%=</span> <span class="n">time_ago_in_words</span> <span class="n">order_item</span><span class="p">.</span><span class="nf">created_at</span> <span class="cp">%&gt;</span>
  <span class="nt">&lt;/p&gt;</span>
</code></pre>
</div>
</div>
<div class='slide'>
<a class='slide_break' id='slide-8' href='slides_internationalization.html#/8'>▻</a>
<h3 id="pluralization">
<a class="anchorlink" href="#pluralization"></a>9 Pluralization</h3><p>The page <code>/order_items</code> gives a list of all orders, and also the number of orders.
Before internationalization this looked like this:</p><div class="code_container">
<pre><code class="highlight erb"><span class="nt">&lt;p&gt;</span>There are <span class="cp">&lt;%=</span> <span class="vi">@order_items</span><span class="p">.</span><span class="nf">length</span> <span class="cp">%&gt;</span> orders in the system.<span class="nt">&lt;/p&gt;</span>
</code></pre>
</div>
<p>When translating this we also have to think about pluralization rules.
English is simple: just add an 's' to the end of the noun for more then one order.
Other languages follow more complex rules.</p><p>You can see how the example from polish in the video above is handled in the
standard translation for dates:</p>
<ul>
<li>Rails Pluralisation Rules for Polish <a href="https://github.com/svenfuchs/rails-i18n/blob/master/rails/pluralization/pl.rb">pluralization/pl.rb</a>
</li>
<li>Use in <a href="https://github.com/svenfuchs/rails-i18n/blob/10141c451f03d7c6b78cfdcce808c389da6b9ddd/rails/locale/pl.yml#L63">locale/pl.rb</a>
</li>
</ul>
<p>To build our own pluralisation rules we can add translations with several cases.
How many cases there are, and what they are called, differs from language
to language.  Make sure to look it up in <a href="https://github.com/svenfuchs/rails-i18n/blob/master/rails/pluralization/">pluralization/*</a></p><div class="code_container">
<pre><code class="highlight yml">  <span class="na">orders_in_the_system</span><span class="pi">:</span>
    <span class="na">zero</span><span class="pi">:</span> <span class="s">Es gibt keine Bestellungen im System</span>
    <span class="na">one</span><span class="pi">:</span> <span class="s">Es gibt eine Bestellung im System</span>
    <span class="na">other</span><span class="pi">:</span> <span class="s">Es gibt %{count} Bestellungen im System</span>
</code></pre>
</div>
</div>
<div class='slide'>
<a class='slide_break' id='slide-9' href='slides_internationalization.html#/9'>▻</a>
<h3 id="translating-model-names-and-attributes">
<a class="anchorlink" href="#translating-model-names-and-attributes"></a>10 Translating Model Names and Attributes</h3><p>The names of models and their attributes will be used
in many places in the app: from labels for form fields
to error messages in validation.</p><p>So it makes sense to store the names of models and their attributes
just once and then reuse them.</p><p>In the demo app there are</p></div>
<div class='slide'>
<a class='slide_break' id='slide-10' href='slides_internationalization.html#/10'>▻</a>
<h3 id="see-also">
<a class="anchorlink" href="#see-also"></a>11 See Also</h3>
<ul>
<li><a href="https://guides.rubyonrails.org/i18n.html">Rails Guide: Internationalization</a></li>
<li><a href="https://metacpan.org/pod/distribution/Locale-Maketext/lib/Locale/Maketext/TPJ13.pod#A-Localization-Horror-Story:-It-Could-Happen-To-You">A Localization Horror Story: It Could Happen To You</a></li>
</ul>
</div>
      </div>
    </div>
  </div>

  <hr class="hide">
  <div id="footer">
    <div class="wrapper">
      <p class="copyright">published under <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/at/deed.de">creative commons by-nc-sa</a> in 2012-2023 by <a href="https://brigitte-jellinek.at">Brigitte Jellinek</a>.
      </p><p>If you want to contribute: <a href="https://github.com/backend-development/backend-development-textbook/fork">fork the source on github</a>
      </p>
    </div>
  </div>

  <script src="javascripts/jquery.min.js"></script>
  <script src="javascripts/guides.js"></script>
  </body>
</html>
