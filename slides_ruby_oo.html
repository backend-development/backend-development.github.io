<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=1024, user-scalable=no">
    <title>Slides for
        Backend Development Textbook
    </title>
    <!-- Required stylesheet -->
    <link rel="stylesheet" media="screen" href="stylesheets/deck.core.css">
    <!-- Extension CSS files go here. Remove or add as needed. -->
    <link rel="stylesheet" media="screen" href="stylesheets/deck.goto.css">
    <link rel="stylesheet" media="screen" href="stylesheets/deck.menu.css">
    <link rel="stylesheet" media="screen" href="stylesheets/deck.navigation.css">
    <link rel="stylesheet" media="screen" href="stylesheets/deck.status.css">
    <!-- Style theme. More available in /themes/style/ or create your own. -->
    <link rel="stylesheet" media="screen" href="stylesheets/web-2.0.css">
    <!-- Transition theme. More available in /themes/transition/ or create your own. -->
    <link rel="stylesheet" media="screen" href="stylesheets/horizontal-slide.css">
    <!-- syntax highlighter -->
    <link rel="stylesheet" type="text/css" href="stylesheets/code.css" />


    <!-- Basic black and white print styles -->
    <link rel="stylesheet" media="print" href="stylesheets/print.css">
    <!-- Required Modernizr file -->
    <script src="javascripts/modernizr.custom.js"></script>
</head>

<body>
    <div class="deck-container">
        <div class='slide'>
</div>
<div class='slide'>
<a class='slide_break' href='ruby_oo.html#slide-1'>▻</a>
<h2>Ruby Object Orientation</h2><p>This guide will take a closer look at objects, classes and modules in Ruby.</p><p>After finishing this guide you will</p>
<ul>
<li>know how to write object methods and use object variables (properties)</li>
<li>know how to write class methods and use class variables (properties)</li>
</ul>

</div>
<div class='slide'>
<a class='slide_break' href='ruby_oo.html#slide-2'>▻</a>
<hr>
</div>
<div class='slide'>
<a class='slide_break' href='ruby_oo.html#slide-3'>▻</a>
<h3 id="to-be-written"><a class="anchorlink" href="#to-be-written">1 To Be Written</a></h3></div>
<div class='slide'>
<a class='slide_break' href='ruby_oo.html#slide-4'>▻</a>
<h3 id="an-investigation-into-declarations"><a class="anchorlink" href="#an-investigation-into-declarations">2 An investigation into Declarations:</a></h3><p>In <a href="rails_associations_and_validations.html">Rails: Associations and Validations</a> we learned that Validation are declared in the model:</p><div class="code_container">
<pre><code class="highlight ruby"><span class="k">class</span> <span class="nc">Tweet</span> <span class="o">&lt;</span> <span class="no">ApplicationRecord</span>
  <span class="n">validates_presence_of</span> <span class="ss">:status</span>
<span class="k">end</span>
</code></pre>
</div>
<p>But what is really happening here?</p><p><code>validates_presence_of</code> is called when the class is defined. it is called only once.</p><div class="code_container">
<pre><code class="highlight ruby"><span class="k">class</span> <span class="nc">Ruby</span>
  <span class="k">def</span> <span class="nf">validates_presence_of</span> <span class="n">x</span>
    <span class="nb">puts</span> <span class="s2">"I should really check for property </span><span class="si">#{</span><span class="n">x</span><span class="si">}</span><span class="s2">"</span>
  <span class="k">end</span>

  <span class="n">validates_presence_of</span> <span class="ss">:color</span>
<span class="k">end</span>

<span class="c1"># in `&lt;class:Ruby&gt;': undefined method `validates_presence_of' for Ruby:Class (NoMethodError)</span>
</code></pre>
</div>
<p><code>validates_presence_of</code> cannot be a normal method, because such a method is not defined yet
when the class is defined. so it needs to be a class method.</p><div class="code_container">
<pre><code class="highlight ruby"><span class="k">class</span> <span class="nc">Ruby</span>
  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">validates_presence_of</span> <span class="n">x</span>
    <span class="nb">puts</span> <span class="s2">"I should really check for property </span><span class="si">#{</span><span class="n">x</span><span class="si">}</span><span class="s2">"</span>
  <span class="k">end</span>

  <span class="n">validates_presence_of</span> <span class="ss">:color</span>
<span class="k">end</span>
</code></pre>
</div>
<p>....</p><div class="code_container">
<pre><code class="highlight ruby"><span class="k">class</span> <span class="nc">ValidatableStuff</span>
  <span class="nb">attr_accessor</span> <span class="ss">:data</span>
  <span class="nb">attr_accessor</span> <span class="ss">:errors</span>
  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">validates_presence_of</span> <span class="n">x</span>
    <span class="nb">puts</span> <span class="s2">"the class </span><span class="si">#{</span><span class="nb">self</span><span class="si">}</span><span class="s2"> should really check for </span><span class="si">#{</span><span class="n">x</span><span class="si">}</span><span class="s2"> - but how?"</span>
    <span class="vc">@@validator_for</span> <span class="o">=</span> <span class="n">x</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">)</span>
    <span class="vi">@data</span> <span class="o">=</span> <span class="n">data</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">save</span>
    <span class="nb">puts</span> <span class="s2">"I am trying to save the data of a </span><span class="si">#{</span><span class="nb">self</span><span class="p">.</span><span class="nf">class</span><span class="si">}</span><span class="s2"> Object. the data is </span><span class="si">#{</span><span class="nb">self</span><span class="p">.</span><span class="nf">data</span><span class="si">}</span><span class="s2">"</span>
    <span class="k">if</span> <span class="nb">self</span><span class="p">.</span><span class="nf">data</span><span class="p">.</span><span class="nf">keys</span><span class="p">.</span><span class="nf">include?</span><span class="p">(</span> <span class="vc">@@validator_for</span> <span class="p">)</span>
      <span class="nb">puts</span> <span class="s2">"this is ok, </span><span class="si">#{</span><span class="vc">@@validator_for</span><span class="si">}</span><span class="s2"> is set"</span>
      <span class="k">return</span> <span class="kp">true</span>
    <span class="k">else</span>
      <span class="nb">puts</span> <span class="s2">"this is not ok, </span><span class="si">#{</span><span class="vc">@@validator_for</span><span class="si">}</span><span class="s2"> needs to be set"</span>
      <span class="nb">self</span><span class="p">.</span><span class="nf">errors</span> <span class="o">=</span> <span class="s2">"</span><span class="si">#{</span><span class="vc">@@validator_for</span><span class="si">}</span><span class="s2"> needs to be set"</span>
      <span class="k">return</span> <span class="kp">false</span>
    <span class="k">end</span>

  <span class="k">end</span>
<span class="k">end</span>


<span class="k">class</span> <span class="nc">Ruby</span> <span class="o">&lt;</span> <span class="no">ValidatableStuff</span>
  <span class="k">def</span> <span class="nf">x</span>
  <span class="k">end</span>

  <span class="n">x</span>
  <span class="n">validates_presence_of</span> <span class="ss">:color</span>
<span class="k">end</span>


<span class="k">class</span> <span class="nc">Diamond</span> <span class="o">&lt;</span> <span class="no">ValidatableStuff</span>
  <span class="n">validates_presence_of</span> <span class="ss">:carat</span>
<span class="k">end</span>

<span class="n">r1</span> <span class="o">=</span> <span class="no">Ruby</span><span class="p">.</span><span class="nf">new</span>
<span class="k">if</span> <span class="n">r1</span><span class="p">.</span><span class="nf">save</span>
  <span class="nb">puts</span> <span class="s2">"saved"</span>
<span class="k">else</span>
  <span class="nb">puts</span> <span class="s2">"errors: </span><span class="si">#{</span><span class="n">r1</span><span class="p">.</span><span class="nf">errors</span><span class="si">}</span><span class="s2">"</span>
<span class="k">end</span>

<span class="n">r2</span> <span class="o">=</span> <span class="no">Ruby</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="ss">color: </span><span class="s1">'yellow'</span><span class="p">)</span>
<span class="n">r2</span><span class="p">.</span><span class="nf">save</span>

<span class="n">d1</span> <span class="o">=</span> <span class="no">Diamond</span><span class="p">.</span><span class="nf">new</span>
<span class="n">d1</span><span class="p">.</span><span class="nf">save</span>

<span class="n">d2</span> <span class="o">=</span> <span class="no">Diamond</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="ss">carat: </span><span class="mi">10</span><span class="p">)</span>
<span class="n">d2</span><span class="p">.</span><span class="nf">save</span>
</code></pre>
</div>
</div>
<div class='slide'>
<a class='slide_break' href='ruby_oo.html#slide-5'>▻</a>
<h4 id="online-resources"><a class="anchorlink" href="#online-resources">2.1 Online Resources</a></h4>
<ul>
<li><a href="http://rubylearning.com/satishtalim/tutorial.html">learningruby.com tutorial</a></li>
</ul>
</div>
<div class='slide'>
<a class='slide_break' href='ruby_oo.html#slide-6'>▻</a>
<h4 id="books"><a class="anchorlink" href="#books">2.2 Books</a></h4>
<ul>
<li><a href="https://www.poodr.com/">Metz, Sandy(2017): Practical Object-Oriented Design in Ruby</a></li>
</ul>
</div>
    </div>
    <!-- End slides. -->
    <!-- Begin extension snippets. Add or remove as needed. -->
    <!-- deck.navigation snippet -->
    <div aria-role="navigation">
        <a href="#" class="deck-prev-link" title="Previous">&#8592;</a>
        <a href="#" class="deck-next-link" title="Next">&#8594;</a>
    </div>
    <!-- deck.status snippet -->
    <p class="deck-status" aria-role="status">
        <span class="deck-status-current"></span>
        /
        <span class="deck-status-total"></span>
    </p>
    <!-- deck.goto snippet -->
    <form action="." method="get" class="goto-form">
        <label for="goto-slide">Go to slide:</label>
        <input type="text" name="slidenum" id="goto-slide" list="goto-datalist">
        <datalist id="goto-datalist"></datalist>
        <input type="submit" value="Go">
    </form>
    <!-- End extension snippets. -->
    <!-- Required JS files. -->
    <script src="javascripts/jquery.min.js"></script>
    <script src="javascripts/deck.core.js"></script>
    <!-- Extension JS files. Add or remove as needed. -->
    <script src="javascripts/deck.menu.js"></script>
    <script src="javascripts/deck.goto.js"></script>
    <script src="javascripts/deck.status.js"></script>
    <script src="javascripts/deck.navigation.js"></script>
    <script src="javascripts/deck.escape.js"></script>

    <!-- Initialize the deck. You can put this in an external file if desired. -->
    <script>
    $(function() {
      $.deck('.slide');
    });

    var $d = $(document);    

    $d.bind('deck.change', function(event, from, to) {
      // console.log('Moving from slide ' + from + ' to ' + to);
    });   
    $d.bind('deck.beforeInit', function() {
      // console.log('Deck.beforeInit. hash is ' + document.location.hash);
    });     
    $d.bind('deck.init', function() {
      // console.log('Deck.init is done. hash was ' + document.location.hash);
    }); 
    </script>
</body>

</html>